{"version":3,"file":"static/js/943.f32da683.js","mappings":"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","sources":["webpack://weblog/./src/views/User/change/index.vue","webpack://weblog/src/views/User/change/index.vue","webpack://weblog/./src/views/User/change/index.vue?d044","webpack://weblog/./src/views/User/change/index.vue?9b88"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"root\"},[_c('div',{staticClass:\"session base-info\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_c('span',{staticClass:\"session-title\"},[_vm._v(\"基础信息\")])]),_c('div',{staticClass:\"session-content\"},[_c('el-form',{ref:\"userForm\",staticClass:\"userForm\",attrs:{\"model\":_vm.userForm,\"label-width\":\"6rem\"}},[_c('el-form-item',{attrs:{\"prop\":\"userName\",\"label\":\"用户名\"}},[(!_vm.isEdit)?_c('span',{domProps:{\"textContent\":_vm._s(_vm.user.userName)}}):_c('el-input',{staticStyle:{\"wdith\":\"5rem\"},attrs:{\"type\":\"text\",\"placeholder\":\"输入用户名\"},model:{value:(_vm.userForm.userName),callback:function ($$v) {_vm.$set(_vm.userForm, \"userName\", $$v)},expression:\"userForm.userName\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"headshot\",\"label\":\"用户头像\"}},[(!_vm.isEdit)?_c('el-image',{staticClass:\"userImage\",attrs:{\"src\":_vm.user.headshot || '#',\"alt\":\"\"}}):_c('el-upload',{staticClass:\"avatar-uploader\",attrs:{\"action\":_vm.$upload_path,\"show-file-list\":false,\"on-success\":_vm.handleAvatarSuccess,\"on-error\":_vm.handleAvatarError,\"before-upload\":_vm.beforeAvatarUpload}},[(_vm.imageUrl)?_c('el-image',{staticClass:\"avatar\",attrs:{\"src\":_vm.imageUrl || '#'}}):_c('i',{staticClass:\"el-icon-plus avatar-uploader-icon\"})],1)],1),_c('el-form-item',{attrs:{\"prop\":\"phone\",\"label\":\"手机号\"}},[(!_vm.isEdit)?_c('span',{domProps:{\"textContent\":_vm._s(_vm.user.phone)}}):_c('el-input',{staticStyle:{\"wdith\":\"5rem\"},attrs:{\"type\":\"text\",\"placeholder\":\"更改手机号绑定\"},model:{value:(_vm.userForm.phone),callback:function ($$v) {_vm.$set(_vm.userForm, \"phone\", $$v)},expression:\"userForm.phone\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"email\",\"label\":\"邮箱\"}},[(!_vm.isEdit)?_c('span',{domProps:{\"textContent\":_vm._s(_vm.user.email)}}):_c('el-input',{staticStyle:{\"wdith\":\"5rem\"},attrs:{\"type\":\"text\",\"placeholder\":\"更改邮箱绑定\"},model:{value:(_vm.userForm.email),callback:function ($$v) {_vm.$set(_vm.userForm, \"email\", $$v)},expression:\"userForm.email\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},domProps:{\"textContent\":_vm._s(_vm.isEdit ? '修改' : '编辑')},on:{\"click\":_vm.handleChange}})],1)],1)],1)],1),_c('div',{staticClass:\"session base-info\"},[_c('el-divider',{attrs:{\"content-position\":\"left\"}},[_c('span',{staticClass:\"session-title\"},[_vm._v(\"修改密码\")])]),_c('div',{staticClass:\"session-content\"},[_c('el-form',{ref:\"userForm\",staticClass:\"userForm\",attrs:{\"model\":_vm.passwordForm,\"label-width\":\"6rem\"}},[_c('el-form-item',{attrs:{\"prop\":\"prePassword\",\"label\":\"原密码\"}},[_c('el-input',{staticStyle:{\"wdith\":\"5rem\"},attrs:{\"type\":\"text\",\"placeholder\":\"输入新密码\"},model:{value:(_vm.passwordForm.prePassword),callback:function ($$v) {_vm.$set(_vm.passwordForm, \"prePassword\", $$v)},expression:\"passwordForm.prePassword\"}})],1),_c('el-form-item',{attrs:{\"prop\":\"newPassword\",\"label\":\"新密码\"}},[_c('el-input',{staticStyle:{\"wdith\":\"5rem\"},attrs:{\"type\":\"text\",\"placeholder\":\"输入新密码\"},model:{value:(_vm.passwordForm.newPassword),callback:function ($$v) {_vm.$set(_vm.passwordForm, \"newPassword\", $$v)},expression:\"passwordForm.newPassword\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},domProps:{\"textContent\":_vm._s('修改')},on:{\"click\":_vm.handleChangePassword}})],1)],1)],1)],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"root\">\r\n    <!-- 基础信息修改 -->\r\n    <div class=\"session base-info\">\r\n      <el-divider content-position=\"left\">\r\n        <span class=\"session-title\">基础信息</span>\r\n      </el-divider>\r\n\r\n      <div class=\"session-content\">\r\n        <el-form\r\n          class=\"userForm\"\r\n          ref=\"userForm\"\r\n          :model=\"userForm\"\r\n          label-width=\"6rem\"\r\n        >\r\n          <el-form-item prop=\"userName\" label=\"用户名\">\r\n            <span v-text=\"user.userName\" v-if=\"!isEdit\"></span>\r\n            <el-input\r\n              v-else\r\n              type=\"text\"\r\n              v-model=\"userForm.userName\"\r\n              placeholder=\"输入用户名\"\r\n              style=\"wdith: 5rem\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"headshot\" label=\"用户头像\">\r\n            <el-image\r\n              :src=\"user.headshot || '#'\"\r\n              alt=\"\"\r\n              class=\"userImage\"\r\n              v-if=\"!isEdit\"\r\n            ></el-image>\r\n            <el-upload\r\n              class=\"avatar-uploader\"\r\n              :action=\"$upload_path\"\r\n              :show-file-list=\"false\"\r\n              :on-success=\"handleAvatarSuccess\"\r\n              :on-error=\"handleAvatarError\"\r\n              :before-upload=\"beforeAvatarUpload\"\r\n              v-else\r\n            >\r\n              <el-image v-if=\"imageUrl\" :src=\"imageUrl || '#'\" class=\"avatar\" />\r\n              <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n            </el-upload>\r\n          </el-form-item>\r\n          <el-form-item prop=\"phone\" label=\"手机号\">\r\n            <span v-text=\"user.phone\" v-if=\"!isEdit\"></span>\r\n            <el-input\r\n              v-else\r\n              type=\"text\"\r\n              v-model=\"userForm.phone\"\r\n              placeholder=\"更改手机号绑定\"\r\n              style=\"wdith: 5rem\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"email\" label=\"邮箱\">\r\n            <span v-text=\"user.email\" v-if=\"!isEdit\"></span>\r\n            <el-input\r\n              v-else\r\n              type=\"text\"\r\n              v-model=\"userForm.email\"\r\n              placeholder=\"更改邮箱绑定\"\r\n              style=\"wdith: 5rem\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button\r\n              v-text=\"isEdit ? '修改' : '编辑'\"\r\n              type=\"primary\"\r\n              @click=\"handleChange\"\r\n            ></el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"session base-info\">\r\n      <el-divider content-position=\"left\">\r\n        <span class=\"session-title\">修改密码</span>\r\n      </el-divider>\r\n\r\n      <div class=\"session-content\">\r\n        <el-form\r\n          class=\"userForm\"\r\n          ref=\"userForm\"\r\n          :model=\"passwordForm\"\r\n          label-width=\"6rem\"\r\n        >\r\n          <el-form-item prop=\"prePassword\" label=\"原密码\">\r\n            <el-input\r\n              type=\"text\"\r\n              v-model=\"passwordForm.prePassword\"\r\n              placeholder=\"输入新密码\"\r\n              style=\"wdith: 5rem\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item prop=\"newPassword\" label=\"新密码\">\r\n            <el-input\r\n              type=\"text\"\r\n              v-model=\"passwordForm.newPassword\"\r\n              placeholder=\"输入新密码\"\r\n              style=\"wdith: 5rem\"\r\n            ></el-input>\r\n          </el-form-item>\r\n          <el-form-item>\r\n            <el-button\r\n              v-text=\"'修改'\"\r\n              type=\"primary\"\r\n              @click=\"handleChangePassword\"\r\n            ></el-button>\r\n          </el-form-item>\r\n        </el-form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapMutations, mapActions } from \"vuex\";\r\nexport default {\r\n  name: \"changePage\",\r\n  data() {\r\n    return {\r\n      userForm: {},\r\n      passwordForm: {\r\n        prePassword: \"\",\r\n        newPassword: \"\",\r\n      },\r\n      isEdit: false,\r\n      isChangePassword: false,\r\n      imageUrl: \"\",\r\n    };\r\n  },\r\n  mounted() {\r\n    this.userForm = this.user;\r\n  },\r\n  computed: {\r\n    user() {\r\n      const user = this.$store.state.user;\r\n      return user.token ? user.userInfo : false;\r\n    },\r\n  },\r\n  methods: {\r\n    ...mapMutations(\"user\", [\"UpdateUserInfo\"]),\r\n    ...mapActions(\"user\", [\"updateUserInfo\", \"getUserInfo\", 'updatePassword']),\r\n\r\n    // 修改密码\r\n    async handleChangePassword() {\r\n      try {\r\n          const { data: res } = await this.updatePassword({\r\n            userId: this.user.id,\r\n            ...this.passwordForm,\r\n          });\r\n          if (res.code === 200) {\r\n            this.$message.success(res.msg);\r\n          } else {\r\n            this.$message.error(res.msg)\r\n          }\r\n        } catch (e) {\r\n          this.$message.error(e);\r\n        }\r\n    },\r\n\r\n    //修改基础信息\r\n    async handleChange() {\r\n      if (this.isEdit) {\r\n        try {\r\n          const { data: res } = await this.updateUserInfo({\r\n            userId: this.user.id,\r\n            ...this.userForm,\r\n          });\r\n          if (res.code === 200) {\r\n            this.$message.success(\"信息修改成功！\");\r\n\r\n            const { data: res2 } = await this.getUserInfo({\r\n              userId: this.user.id,\r\n            });\r\n            console.log(res2);\r\n            if (res2.code === 200) {\r\n              this.UpdateUserInfo(res2.data);\r\n            }\r\n          }\r\n        } catch (e) {\r\n          this.$message.error(e);\r\n        }\r\n      }\r\n      this.isEdit = !this.isEdit;\r\n    },\r\n\r\n    handleAvatarSuccess(res, file) {\r\n      this.imageUrl = URL.createObjectURL(file.raw);\r\n    },\r\n    handleAvatarError(err, file, fileList) {\r\n      this.$message.error(\"文件上传失败！\");\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      console.log(file);\r\n      const isJPG = file.type === \"image/jpeg\";\r\n      const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n      if (!isJPG) {\r\n        this.$message.error(\"上传头像图片只能是 JPG 格式!\");\r\n      }\r\n      if (!isLt2M) {\r\n        this.$message.error(\"上传头像图片大小不能超过 2MB!\");\r\n      }\r\n      return isJPG && isLt2M;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang='scss'>\r\n.root {\r\n  display: flex;\r\n  justify-content: space-between;\r\n\r\n  .session {\r\n    width: 45%;\r\n  }\r\n}\r\n\r\n.session-title {\r\n  color: var(--bgc-clr6);\r\n  font-size: 2em;\r\n  font-weight: bold;\r\n}\r\n\r\n.base-info {\r\n  width: 50%;\r\n}\r\n\r\n.session-content {\r\n  margin: 3rem 0 7rem 0;\r\n}\r\n.userImage {\r\n  width: 10rem;\r\n}\r\n\r\n.avatar-uploader {\r\n  .el-upload {\r\n    border: 1px dashed var(--bgc-clr6);\r\n    border-radius: 0.5rem;\r\n    cursor: pointer;\r\n    position: relative;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .el-upload:hover {\r\n    border-color: var(--bgc-clr2);\r\n  }\r\n\r\n  .avatar {\r\n    width: 8rem;\r\n    height: 8rem;\r\n    display: block;\r\n  }\r\n\r\n  .avatar-uploader-icon {\r\n    font-size: 1.5rem;\r\n    color: var(--bgc-clr4);\r\n    width: 8rem;\r\n    height: 8rem;\r\n    line-height: 8rem;\r\n    text-align: center;\r\n    border-radius: 0.5rem;\r\n    border: 1px dashed var(--bgc-clr4);\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=837184be&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=837184be&prod&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"837184be\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","_v","ref","userForm","isEdit","staticStyle","model","value","userName","callback","$$v","$set","expression","domProps","_s","user","$upload_path","handleAvatarSuccess","handleAvatarError","beforeAvatarUpload","imageUrl","headshot","phone","email","on","handleChange","passwordForm","prePassword","newPassword","handleChangePassword","staticRenderFns","name","data","isChangePassword","mounted","computed","methods","userId","console","component"],"sourceRoot":""}