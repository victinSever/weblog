{"version":3,"file":"static/js/129.8bc67046.js","mappings":"yJAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,UAAUA,EAAG,SAAS,CAACE,YAAY,QAAQ,CAACF,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,SAAS,CAACE,YAAY,gBAAgB,CAACF,EAAG,UAAU,CAACE,YAAY,YAAY,CAACF,EAAG,MAAM,CAACE,YAAY,cAAcJ,EAAIK,GAAIL,EAAIM,OAAO,SAASC,GAAM,OAAOL,EAAG,OAAO,CAACM,IAAID,EAAKE,MAAMC,MAAM,cAAgBV,EAAIW,cAAgBJ,EAAKE,MAAQ,UAAY,IAAIG,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOb,EAAIc,wBAAwBP,EAAKE,MAAM,IAAI,CAACT,EAAIe,GAAGf,EAAIgB,GAAGT,EAAKU,SAAS,IAAG,GAA+B,IAA3BjB,EAAIkB,YAAYC,OAAcjB,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,cAAc,CAACkB,MAAM,CAAC,YAAcpB,EAAIkB,YAAY,QAAUlB,EAAIqB,YAAY,GAAIrB,EAAIsB,UAAWpB,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,gBAAgB,GAAGA,EAAG,MAAM,CAACE,YAAY,SAAS,CAACF,EAAG,WAAW,CAACkB,MAAM,CAAC,aAAa,IAAI,YAAc,cAAc,MAAM,GAAGlB,EAAG,SAAS,CAACE,YAAY,mBAAmB,MAAM,EACl5B,EACImB,EAAkB,G,4CC0CtB,MAAMjB,EAAQ,CACd,CAAAW,MAAAA,OAAAR,MAAAA,GACA,CAAAQ,MAAAA,OAAAR,MAAAA,GACA,CAAAQ,MAAAA,OAAAR,MAAAA,IAGA,OACAe,KAAAA,cACAC,WAAAA,CAAAC,OAAAA,EAAAA,EAAAC,YAAAA,EAAAA,GACAC,OACA,OACAV,YAAAA,GACAZ,QACAK,YAAAA,EACAU,QAAAA,GACAC,WAAAA,EACAO,QAAAA,CACAC,KAAAA,EACAC,KAAAA,GAGA,EACAC,MAAAA,CACAC,OAAAA,CACAC,WAAAA,EACAC,UACA,mCACA,cACA,IAGAC,SAAAA,CACAC,OACA,+BACA,2BACA,GAEAC,UACAC,OAAAA,iBAAAA,SAAAA,KAAAA,cAAAA,EACA,EACAC,gBACAD,OAAAA,oBAAAA,SAAAA,KAAAA,cAAAA,EACA,EACAE,QAAAA,KACA,mBACA,mBACA,gBACA,qBAGA,iBACA,IACA,kBACA,SACAC,OAAAA,KAAAA,KAAAA,GACArB,QAAAA,KAAAA,WACA,cAEA,SACA,yBACA,OACAO,QAAAA,KAAAA,iBAAAA,GACA,MACA,OACAe,QAAAA,IAAAA,GACAf,QAAAA,KAAAA,iBAAAA,GACA,MACA,OACAA,QAAAA,KAAAA,cAAAA,GACA,MACA,QACA,2BAGA,GADA,kBACA,0CACA,qCACA,mEAGA,CAFA,SACA,sBACA,CACA,EAEAgB,UACA,oBACA,gBACA,EAGAC,eACA,QACAC,SAAAA,KAAAA,aAAAA,OAAAA,YAAAA,OAAAA,YACA,SACA,yBACA,YACAC,EAAAA,EAAAA,IAAAA,EAAAA,UAAAA,IACA,CACA,EAEAjC,wBAAAA,GACA,mBACA,cACA,ICjJ8P,I,UCQ1PkC,GAAY,OACd,EACAjD,EACAwB,GACA,EACA,KACA,WACA,MAIF,EAAeyB,EAAiB,O","sources":["webpack://weblog/./src/views/Search/index.vue","webpack://weblog/src/views/Search/index.vue","webpack://weblog/./src/views/Search/index.vue?527b","webpack://weblog/./src/views/Search/index.vue?fbd9"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('Header'),_c('el-row',{staticClass:\"main\"},[_c('div',{staticClass:\"main-inner\"},[_c('el-col',{staticClass:\"message-left\"},[_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"order-list\"},_vm._l((_vm.order),function(item){return _c('span',{key:item.value,class:'order-item' + (_vm.orderActive === item.value ? ' active' : ''),on:{\"click\":function($event){return _vm.handleChangeOrderActive(item.value)}}},[_vm._v(_vm._s(item.label))])}),0),(_vm.passageList.length !== 0)?_c('div',{staticClass:\"passage-list\"},[_c('PassageList',{attrs:{\"passageList\":_vm.passageList,\"keyword\":_vm.keyword}})],1):(_vm.isLoading)?_c('div',{staticClass:\"loading\"},[_c('el-skeleton')],1):_c('div',{staticClass:\"empty\"},[_c('el-empty',{attrs:{\"image-size\":200,\"description\":\"内容空空如也！\"}})],1)])],1),_c('el-col',{staticClass:\"message-right\"})],1)])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div>\r\n    <Header />\r\n    <el-row class=\"main\">\r\n      <div class=\"main-inner\">\r\n        <el-col class=\"message-left\">\r\n          <el-card class=\"box-card\">\r\n            <div class=\"order-list\">\r\n              <span\r\n                v-for=\"item in order\"\r\n                :key=\"item.value\"\r\n                :class=\"\r\n                  'order-item' + (orderActive === item.value ? ' active' : '')\r\n                \"\r\n                @click=\"handleChangeOrderActive(item.value)\"\r\n                >{{ item.label }}</span\r\n              >\r\n            </div>\r\n            <div class=\"passage-list\" v-if=\"passageList.length !== 0\">\r\n              <PassageList :passageList=\"passageList\" :keyword=\"keyword\" />\r\n            </div>\r\n            <div class=\"loading\" v-else-if=\"isLoading\">\r\n              <el-skeleton />\r\n            </div>\r\n            <div class=\"empty\" v-else>\r\n              <el-empty\r\n                :image-size=\"200\"\r\n                description=\"内容空空如也！\"\r\n              ></el-empty>\r\n            </div>\r\n          </el-card>\r\n        </el-col>\r\n        <el-col class=\"message-right\"> </el-col>\r\n      </div>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Header from \"@/components/Header\";\r\nimport PassageList from \"@/components/passage/passage-list.vue\";\r\nimport { mapActions } from \"vuex\";\r\nimport { throttle } from \"@/utils\";\r\n\r\nconst order = [\r\n  { label: \"综合排序\", value: 1 },\r\n  { label: \"最新优先\", value: 2 },\r\n  { label: \"最热优先\", value: 3 },\r\n];\r\n\r\nexport default {\r\n  name: \"SearchPages\",\r\n  components: { Header, PassageList },\r\n  data() {\r\n    return {\r\n      passageList: [],\r\n      order,\r\n      orderActive: 1,\r\n      keyword: \"\",\r\n      isLoading: false,\r\n      pageMap: {\r\n        page: 1,\r\n        size: 5,\r\n      },\r\n    };\r\n  },\r\n  watch: {\r\n    $route: {\r\n      immediate: true,\r\n      handler() {\r\n        this.keyword = this.$route.query.key;\r\n        this.getData();\r\n      },\r\n    },\r\n  },\r\n  computed: {\r\n    user() {\r\n      const user = this.$store.state.user;\r\n      return user.token ? user.userInfo : false;\r\n    },\r\n  },\r\n  mounted() {\r\n    window.addEventListener(\"scroll\", this.handleScroll, false);\r\n  },\r\n  beforeDestroy() {\r\n    window.removeEventListener(\"scroll\", this.handleScroll, false);\r\n  },\r\n  methods: {\r\n    ...mapActions(\"passage\", [\r\n      \"searchAdviceBlog\",\r\n      \"searchHotBlog\",\r\n      \"searchLatestBlog\",\r\n    ]),\r\n\r\n    async getData(type) {\r\n      try {\r\n        this.isLoading = true;\r\n        const params = {\r\n          userId: this.user.id,\r\n          keyword: this.keyword,\r\n          ...this.pageMap,\r\n        };\r\n        let data = {};\r\n        switch (this.orderActive) {\r\n          case 1:\r\n            data = await this.searchAdviceBlog(params);\r\n            break;\r\n          case 2:\r\n            console.log(params);\r\n            data = await this.searchLatestBlog(params);\r\n            break;\r\n          case 3:\r\n            data = await this.searchHotBlog(params);\r\n            break;\r\n          default:\r\n            this.$message.error(\"出错了\");\r\n        }\r\n        this.isLoading = false;\r\n        if (data.data.code !== 200 || data.data.data.length === 0)\r\n          return this.$message.info(\"没有更多数据了\");\r\n        this.passageList = type ? this.passageList.concat(data.data.data) : data.data.data\r\n      } catch (e) {\r\n        this.$message.error(e);\r\n      }\r\n    },\r\n\r\n    addPage() {\r\n      this.pageMap.page++;\r\n      this.getData(true);\r\n    },\r\n\r\n    // 监听鼠标位置，在到达地步150px长度触底，进行数据懒加载\r\n    handleScroll() {\r\n      const dis =\r\n        document.body.offsetHeight - window.pageYOffset - window.innerHeight;\r\n      if (dis <= 5) {\r\n        if (this.isLoading) return; //节流\r\n        let that = this;\r\n        throttle(that.addPage(), 1000); //节流函数，每1000ms触发一次\r\n      }\r\n    },\r\n\r\n    handleChangeOrderActive(id) {\r\n      this.orderActive = id;\r\n      this.getData()\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped lang='scss'>\r\n\r\n.active {\r\n  color: #1e80ff;\r\n}\r\n\r\n.main {\r\n  margin-top: 20px;\r\n\r\n  .main-inner {\r\n    width: 70rem;\r\n    margin: 0 auto;\r\n\r\n    .message-left {\r\n      width: 75%;\r\n      background-color: #fff;\r\n\r\n      .box-card{\r\n        min-height: 95vh;\r\n      }\r\n      \r\n\r\n      .order-list {\r\n        margin-bottom: 2rem;\r\n      }\r\n\r\n      .passage-list {\r\n        \r\n      }\r\n    }\r\n\r\n    .message-right {\r\n      float: right;\r\n      width: 22%;\r\n    }\r\n  }\r\n}\r\n\r\n.order-list {\r\n  font-size: 14px;\r\n  color: #71777c;\r\n\r\n  .order-item {\r\n    margin-right: 15px;\r\n    cursor: pointer;\r\n  }\r\n\r\n  .order-item:hover {\r\n    color: #1e80ff;\r\n  }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=041714f8&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=041714f8&prod&scoped=true&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"041714f8\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","_l","order","item","key","value","class","orderActive","on","$event","handleChangeOrderActive","_v","_s","label","passageList","length","attrs","keyword","isLoading","staticRenderFns","name","components","Header","PassageList","data","pageMap","page","size","watch","$route","immediate","handler","computed","user","mounted","window","beforeDestroy","methods","userId","console","addPage","handleScroll","document","throttle","component"],"sourceRoot":""}