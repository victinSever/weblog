"use strict";(self["webpackChunkweblog"]=self["webpackChunkweblog"]||[]).push([[576],{15205:function(e,a,s){s.r(a),s.d(a,{default:function(){return v}});var t=function(){var e=this,a=e._self._c;return a("div",[a("Header"),a("el-row",{staticClass:"main"},[a("div",{staticClass:"main-inner"},[a("el-col",{staticClass:"message-left"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"order-list"},e._l(e.order,(function(s){return a("span",{key:s.value,class:"order-item"+(e.orderActive===s.value?" active":""),on:{click:function(a){return e.handleChangeOrderActive(s.value)}}},[e._v(e._s(s.label))])})),0),0!==e.passageList.length?a("div",{staticClass:"passage-list"},[a("PassageList",{attrs:{passageList:e.passageList,keyword:e.keyword}})],1):e.isLoading?a("div",{staticClass:"loading"},[a("el-skeleton")],1):a("div",{staticClass:"empty"},[a("el-empty",{attrs:{"image-size":200,description:"内容空空如也！"}})],1)])],1),a("el-col",{staticClass:"message-right"})],1)])],1)},i=[],r=s(75457),o=s(58493),l=s(20629),d=s(42325);const n=[{label:"综合排序",value:1},{label:"最新优先",value:2},{label:"最热优先",value:3}];var c={name:"SearchPages",components:{Header:r.Z,PassageList:o.Z},data(){return{passageList:[],order:n,orderActive:1,keyword:"",isLoading:!1,pageMap:{page:1,size:5}}},watch:{$route:{immediate:!0,handler(){this.keyword=this.$route.query.key,this.getData()}}},computed:{user(){const e=this.$store.state.user;return!!e.token&&e.userInfo}},mounted(){window.addEventListener("scroll",this.handleScroll,!1)},beforeDestroy(){window.removeEventListener("scroll",this.handleScroll,!1)},methods:{...(0,l.nv)("passage",["searchAdviceBlog","searchHotBlog","searchLatestBlog"]),async getData(e){try{this.isLoading=!0;const a={userId:this.user.id,keyword:this.keyword,...this.pageMap};let s={};switch(this.orderActive){case 1:s=await this.searchAdviceBlog(a);break;case 2:console.log(a),s=await this.searchLatestBlog(a);break;case 3:s=await this.searchHotBlog(a);break;default:this.$message.error("出错了")}if(this.isLoading=!1,200!==s.data.code||0===s.data.data.length)return this.$message.info("没有更多数据了");this.passageList=e?this.passageList.concat(s.data.data):s.data.data}catch(a){this.$message.error(a)}},addPage(){this.pageMap.page++,this.getData(!0)},handleScroll(){const e=document.body.offsetHeight-window.pageYOffset-window.innerHeight;if(e<=5){if(this.isLoading)return;let e=this;(0,d.P2)(e.addPage(),1e3)}},handleChangeOrderActive(e){this.orderActive=e,this.getData()}}},h=c,g=s(1001),u=(0,g.Z)(h,t,i,!1,null,"25dc25a8",null),v=u.exports}}]);
//# sourceMappingURL=576.eedf99f8.js.map