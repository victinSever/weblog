"use strict";(self["webpackChunkweblog"]=self["webpackChunkweblog"]||[]).push([[486],{78486:function(t,e,o){o.r(e),o.d(e,{default:function(){return u}});var s=function(){var t=this,e=t._self._c;return e("div",[e("el-divider",{attrs:{"content-position":"center"}},[e("span",{staticClass:"session-title",staticStyle:{color:"var(--bgc-clr6)","font-size":"2em","font-weight":"bold"}},[t._v("专栏管理（"+t._s(t.total||"0")+"）")])]),e("div",{staticClass:"create-header"},[e("el-link",{staticClass:"create-btns",attrs:{type:"primary"},domProps:{textContent:t._s(t.showCreateBox?"保存":"新建专栏")},on:{click:t.handleCreateColumn}}),t.showCreateBox?e("el-link",{staticClass:"create-btns qvxiao",attrs:{type:"primary"},domProps:{textContent:t._s("取消")},on:{click:function(e){t.showCreateBox=!1}}}):t._e()],1),t.showCreateBox?e("el-card",{staticClass:"create-box"},[e("el-form",{attrs:{model:t.columnForm,rules:t.columnRules,"label-width":"100px"}},[e("el-form-item",{attrs:{prop:"column",label:"专栏名称"}},[e("el-input",{staticStyle:{"max-width":"20rem"},attrs:{placeholder:"请输入专栏名称"},model:{value:t.columnForm.column,callback:function(e){t.$set(t.columnForm,"column",e)},expression:"columnForm.column"}})],1),e("el-form-item",{attrs:{prop:"discription",label:"专栏描述"}},[e("el-input",{attrs:{placeholder:"请输入专栏描述"},model:{value:t.columnForm.discription,callback:function(e){t.$set(t.columnForm,"discription",e)},expression:"columnForm.discription"}})],1),e("el-form-item",{attrs:{prop:"cover",label:"专栏封面"}},[e("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.$upload_path,"show-file-list":!1,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.columnForm.cover?e("el-image",{staticClass:"avatar",attrs:{src:t.columnForm.cover||"#"}}):e("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1)],1)],1)],1):t._e(),e("div",{staticClass:"container"},t._l(t.columnList,(function(o){return e("div",{key:o.id,staticClass:"drop"},[e("div",{staticClass:"content"},[e("h2",{domProps:{textContent:t._s(o.column_name)}}),e("p",{domProps:{textContent:t._s(o.discription)}}),e("a",{attrs:{href:"#"},on:{click:function(e){return t.gotoColumn(o)}}},[t._v("Read More")])])])})),0)],1)},r=[],a=(o(57658),o(20629)),l={name:"columnPage",data(){return{columnList:[],total:0,dialogVisible:!1,columnForm:{column:"",discription:"",cover:""},columnRules:{column:[{required:!0,message:"请输入专栏名称",trigger:"blur"}],discription:[{required:!0,message:"请输入专栏描述",trigger:"blur"}],cover:[{required:!0,message:"请上传专栏封面",trigger:"change"}]},showCreateBox:!1}},mounted(){this.getData()},computed:{user(){const t=this.$store.state.user;return!!t.token&&t.userInfo}},methods:{...(0,a.nv)("person",["selectColumnByUserId","insertColumn"]),handleCreateColumn(){this.showCreateBox?this.createColumn():this.showCreateBox=!0},async createColumn(){try{const{data:t}=await this.insertColumn({userId:this.user.id,...this.columnForm});console.log(t),200===t.code?(this.showCreateBox=!1,this.$message.success("专栏创建成功！"),this.getData()):this.$message.error(t.msg)}catch(t){this.$message.error(t)}},handleAvatarSuccess(t,e){console.log(t),this.columnForm.cover=t.data.minIoUrl},beforeAvatarUpload(t){const e=t.size/1024/1024<5;return e||this.$message.error("上传头像图片大小不能超过 5MB!"),e},async getData(){try{const{data:t}=await this.selectColumnByUserId({userId:this.user.id});200==t.code&&(this.columnList=t.data,this.total=t.map.total)}catch(t){this.$message.error(t)}},gotoColumn(t){this.$router.push({path:`/user/column/${t.columnId}`,query:t})}}},n=l,i=o(1001),c=(0,i.Z)(n,s,r,!1,null,"636ea641",null),u=c.exports}}]);
//# sourceMappingURL=486.612f66d1.js.map