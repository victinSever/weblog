"use strict";(self["webpackChunkweblog"]=self["webpackChunkweblog"]||[]).push([[943],{39943:function(e,s,t){t.r(s),t.d(s,{default:function(){return m}});var r=function(){var e=this,s=e._self._c;return s("div",{staticClass:"root"},[s("div",{staticClass:"session base-info"},[s("el-divider",{attrs:{"content-position":"left"}},[s("span",{staticClass:"session-title"},[e._v("基础信息")])]),s("div",{staticClass:"session-content"},[s("el-form",{ref:"userForm",staticClass:"userForm",attrs:{model:e.userForm,"label-width":"6rem"}},[s("el-form-item",{attrs:{prop:"userName",label:"用户名"}},[e.isEdit?s("el-input",{staticStyle:{wdith:"5rem"},attrs:{type:"text",placeholder:"输入用户名"},model:{value:e.userForm.userName,callback:function(s){e.$set(e.userForm,"userName",s)},expression:"userForm.userName"}}):s("span",{domProps:{textContent:e._s(e.user.userName)}})],1),s("el-form-item",{attrs:{prop:"headshot",label:"用户头像"}},[e.isEdit?s("el-upload",{staticClass:"avatar-uploader",attrs:{action:e.$upload_path,"show-file-list":!1,"on-success":e.handleAvatarSuccess,"on-error":e.handleAvatarError,"before-upload":e.beforeAvatarUpload}},[e.imageUrl?s("el-image",{staticClass:"avatar",attrs:{src:e.imageUrl||"#"}}):s("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1):s("el-image",{staticClass:"userImage",attrs:{src:e.user.headshot||"#",alt:""}})],1),s("el-form-item",{attrs:{prop:"phone",label:"手机号"}},[e.isEdit?s("el-input",{staticStyle:{wdith:"5rem"},attrs:{type:"text",placeholder:"更改手机号绑定"},model:{value:e.userForm.phone,callback:function(s){e.$set(e.userForm,"phone",s)},expression:"userForm.phone"}}):s("span",{domProps:{textContent:e._s(e.user.phone)}})],1),s("el-form-item",{attrs:{prop:"email",label:"邮箱"}},[e.isEdit?s("el-input",{staticStyle:{wdith:"5rem"},attrs:{type:"text",placeholder:"更改邮箱绑定"},model:{value:e.userForm.email,callback:function(s){e.$set(e.userForm,"email",s)},expression:"userForm.email"}}):s("span",{domProps:{textContent:e._s(e.user.email)}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},domProps:{textContent:e._s(e.isEdit?"修改":"编辑")},on:{click:e.handleChange}})],1)],1)],1)],1),s("div",{staticClass:"session base-info"},[s("el-divider",{attrs:{"content-position":"left"}},[s("span",{staticClass:"session-title"},[e._v("修改密码")])]),s("div",{staticClass:"session-content"},[s("el-form",{ref:"userForm",staticClass:"userForm",attrs:{model:e.passwordForm,"label-width":"6rem"}},[s("el-form-item",{attrs:{prop:"prePassword",label:"原密码"}},[s("el-input",{staticStyle:{wdith:"5rem"},attrs:{type:"text",placeholder:"输入新密码"},model:{value:e.passwordForm.prePassword,callback:function(s){e.$set(e.passwordForm,"prePassword",s)},expression:"passwordForm.prePassword"}})],1),s("el-form-item",{attrs:{prop:"newPassword",label:"新密码"}},[s("el-input",{staticStyle:{wdith:"5rem"},attrs:{type:"text",placeholder:"输入新密码"},model:{value:e.passwordForm.newPassword,callback:function(s){e.$set(e.passwordForm,"newPassword",s)},expression:"passwordForm.newPassword"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},domProps:{textContent:e._s("修改")},on:{click:e.handleChangePassword}})],1)],1)],1)],1)])},a=[],o=t(20629),i={name:"changePage",data(){return{userForm:{},passwordForm:{prePassword:"",newPassword:""},isEdit:!1,isChangePassword:!1,imageUrl:""}},mounted(){this.userForm=this.user},computed:{user(){const e=this.$store.state.user;return!!e.token&&e.userInfo}},methods:{...(0,o.OI)("user",["UpdateUserInfo"]),...(0,o.nv)("user",["updateUserInfo","getUserInfo","updatePassword"]),async handleChangePassword(){try{const{data:e}=await this.updatePassword({userId:this.user.id,...this.passwordForm});200===e.code?this.$message.success(e.msg):this.$message.error(e.msg)}catch(e){this.$message.error(e)}},async handleChange(){if(this.isEdit)try{const{data:e}=await this.updateUserInfo({userId:this.user.id,...this.userForm});if(200===e.code){this.$message.success("信息修改成功！");const{data:e}=await this.getUserInfo({userId:this.user.id});console.log(e),200===e.code&&this.UpdateUserInfo(e.data)}}catch(e){this.$message.error(e)}this.isEdit=!this.isEdit},handleAvatarSuccess(e,s){this.imageUrl=URL.createObjectURL(s.raw)},handleAvatarError(e,s,t){this.$message.error("文件上传失败！")},beforeAvatarUpload(e){console.log(e);const s="image/jpeg"===e.type,t=e.size/1024/1024<2;return s||this.$message.error("上传头像图片只能是 JPG 格式!"),t||this.$message.error("上传头像图片大小不能超过 2MB!"),s&&t}}},l=i,n=t(1001),d=(0,n.Z)(l,r,a,!1,null,"837184be",null),m=d.exports}}]);
//# sourceMappingURL=943.f32da683.js.map